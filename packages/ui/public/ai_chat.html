<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <style>
            html,
            body {
                margin: 0;
                padding: 0;
            }
        </style>
    </head>

    <body>
        <flowise-fullchatbot id="flowiseFullchatbot"></flowise-fullchatbot>
        <script>
            function changeText() {
                let flowiseFullchatbotEl = document.querySelector(`#flowiseFullchatbot`)

                if (!flowiseFullchatbotEl.shadowRoot.querySelector('div'))
                    return setTimeout(() => {
                        changeText()
                    }, 15)

                const poweredBy = [...flowiseFullchatbotEl.shadowRoot.querySelectorAll('span')]
                    .reverse()
                    .find((item) => item.innerText.startsWith('Powered by'))

                poweredBy.innerText = `Powered By 北京尚云数智慧科技有限公司`
            }

            window.onload = changeText
        </script>
        <script type="module">
            import Chatbot from 'https://registry.npmmirror.com/flowise-embed/1.2.0/files/dist/web.js'

            const queryData = new URLSearchParams(window.location.search)

            const chatflowid = queryData.get('chatflowid')
            const apiHost = queryData.get('apiHost') ?? 'https://phantom-agent-experimental.cloudladder.net.cn'

            Chatbot.initFull({
                chatflowid,
                apiHost,
                theme: {
                    button: {
                        backgroundColor: '#3B81F6',
                        right: 20,
                        bottom: 20,
                        size: 'medium',
                        iconColor: 'white'
                        // customIconSrc: 'https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/svg/google-messages.svg',
                    },
                    chatWindow: {
                        showTitle: true,
                        title: '尚云数智Bot',
                        // titleAvatarSrc: 'https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/svg/google-messages.svg',
                        welcomeMessage: '你好呀, 我们又见面了!',
                        backgroundColor: '#ffffff',
                        // height: 700,
                        // width: 400,
                        // fontSize: 16,
                        poweredByTextColor: '#303235',
                        // botMessage: {
                        // 	backgroundColor: '#f7f8ff',
                        // 	textColor: '#303235',
                        // 	showAvatar: true,
                        // 	avatarSrc: 'https://raw.githubusercontent.com/zahidkhawaja/langchain-chat-nextjs/main/public/parroticon.png',
                        // },
                        // userMessage: {
                        // 	backgroundColor: '#3B81F6',
                        // 	textColor: '#ffffff',
                        // 	showAvatar: true,
                        // 	avatarSrc: 'https://raw.githubusercontent.com/zahidkhawaja/langchain-chat-nextjs/main/public/usericon.png',
                        // },
                        textInput: {
                            placeholder: '请输入',
                            backgroundColor: '#ffffff',
                            textColor: '#303235',
                            sendButtonColor: '#3B81F6'
                        }
                    }
                }
            })
        </script>
    </body>
</html>
